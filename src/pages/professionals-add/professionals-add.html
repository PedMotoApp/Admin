<ion-header class="bg-theme">
  <ion-navbar>
    <ion-title style="color: white; font-size: 16px;">
      {{ payload ? dataText.edit : dataText.add }}
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content class="page-professionals-add" style="background: #f4f5f8;">
  <ion-grid style="padding: 10px;">
    <!-- Imagem do Perfil -->
    <ion-row *ngIf="base64Image" style="justify-content: center; margin-bottom: 10px;">
      <ion-col col-12 style="text-align: center;">
        <img [src]="base64Image" style="border-radius: 50%; width: 80px; height: 80px; object-fit: cover;" />
        <button ion-button clear small (click)="selectPicture()" style="color: #007bff;">
          {{ dataText.changePic }}
        </button>
        <button ion-button clear small (click)="delPicture()" style="color: #ff4500;">
          {{ dataText.remove }}
        </button>
      </ion-col>
    </ion-row>
    <ion-row *ngIf="!base64Image" style="justify-content: center; margin-bottom: 10px;">
      <ion-col col-12 style="text-align: center;">
        <button ion-button small (click)="selectPicture()" style="background: linear-gradient(90deg, #007bff, #00c4ff); color: white;">
          {{ dataText.addPic }}
        </button>
      </ion-col>
    </ion-row>

    <!-- Botão Dev: Preencher Valores Aleatórios -->
    <!-- <ion-row style="justify-content: center; margin-bottom: 10px;">
      <ion-col col-12 style="text-align: center;">
        <button ion-button small (click)="fillRandomValues()" style="background: linear-gradient(90deg, #ff4500, #ff6347); color: white;">
          Fill Random (Dev)
        </button>
      </ion-col>
    </ion-row> -->

    <!-- Formulário -->
    <form [formGroup]="formGroup" novalidate>
      <ion-row>
        <!-- Nome -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.name}}</ion-label>
            <ion-input type="text" formControlName="name" maxlength="40" (keyup.enter)="focusNext($event, 'lastName')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('name').invalid && formGroup.get('name').touched">
            <span *ngIf="formGroup.get('name').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('name').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('name').errors?.maxlength">{{dataText.errorRegister2}}</span>
          </ion-note>
        </ion-col>

        <!-- Sobrenome -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.lastName}}</ion-label>
            <ion-input type="text" formControlName="lastName" maxlength="40" (keyup.enter)="focusNext($event, 'postCode')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('lastName').invalid && formGroup.get('lastName').touched">
            <span *ngIf="formGroup.get('lastName').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('lastName').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('lastName').errors?.maxlength">{{dataText.errorRegister2}}</span>
          </ion-note>
        </ion-col>

        <!-- CEP -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.postcode}}</ion-label>
            <ion-input type="text" formControlName="postCode" maxlength="8" (keyup.enter)="focusNext($event, 'address')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('postCode').invalid && formGroup.get('postCode').touched">
            <span *ngIf="formGroup.get('postCode').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('postCode').errors?.minlength || formGroup.get('postCode').errors?.maxlength">{{dataText.errorRegister3}}</span>
          </ion-note>
        </ion-col>

        <!-- Endereço -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.address}}</ion-label>
            <ion-input type="text" formControlName="address" maxlength="300" (keyup.enter)="focusNext($event, 'district')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('address').invalid && formGroup.get('address').touched">
            <span *ngIf="formGroup.get('address').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('address').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('address').errors?.maxlength">{{dataText.errorRegister4}}</span>
          </ion-note>
        </ion-col>

        <!-- Bairro -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.district}}</ion-label>
            <ion-input type="text" formControlName="district" maxlength="30" (keyup.enter)="focusNext($event, 'state')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('district').invalid && formGroup.get('district').touched">
            <span *ngIf="formGroup.get('district').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('district').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('district').errors?.maxlength">{{dataText.errorRegister2}}</span>
          </ion-note>
        </ion-col>

        <!-- Estado -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.state}}</ion-label>
            <ion-input type="text" formControlName="state" maxlength="20" (keyup.enter)="focusNext($event, 'city')" (ionChange)="stateChanged($event)"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('state').invalid && formGroup.get('state').touched">
            <span *ngIf="formGroup.get('state').errors?.required">{{dataText.required}}</span>
            <span *ngIf="formGroup.get('state').errors?.minlength">{{dataText.errorRegister5}}</span>
            <span *ngIf="formGroup.get('state').errors?.maxlength">Quantidade de caracteres deve ser menor que 20</span>
          </ion-note>
        </ion-col>

        <!-- Cidade -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.city}}</ion-label>
            <ion-input type="text" formControlName="city" maxlength="300" (keyup.enter)="focusNext($event, 'complement')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('city').invalid && formGroup.get('city').touched">
            <span *ngIf="formGroup.get('city').errors?.required">{{dataText.required}}</span>
            <span *ngIf="formGroup.get('city').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('city').errors?.maxlength">{{dataText.errorRegister4}}</span>
          </ion-note>
        </ion-col>

        <!-- Complemento -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.complement}}</ion-label>
            <ion-input type="text" formControlName="complement" maxlength="30" (keyup.enter)="focusNext($event, 'numero')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('complement').invalid && formGroup.get('complement').touched">
            <span *ngIf="formGroup.get('complement').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('complement').errors?.minlength">{{dataText.errorRegister1}}</span>
            <span *ngIf="formGroup.get('complement').errors?.maxlength">{{dataText.errorRegister2}}</span>
          </ion-note>
        </ion-col>

        <!-- Número -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.numberr}}</ion-label>
            <ion-input type="text" formControlName="numero" maxlength="4" (keyup.enter)="focusNext($event, 'tel')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('numero').invalid && formGroup.get('numero').touched">
            <span *ngIf="formGroup.get('numero').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('numero').errors?.minlength">{{dataText.errorRegister6}}</span>
            <span *ngIf="formGroup.get('numero').errors?.maxlength">{{dataText.errorRegister7}}</span>
          </ion-note>
        </ion-col>

        <!-- Telefone -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.phone}}</ion-label>
            <ion-input type="tel" formControlName="tel" maxlength="11" (keyup.enter)="focusNext($event, 'cpf')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('tel').invalid && formGroup.get('tel').touched">
            <span *ngIf="formGroup.get('tel').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('tel').errors?.minlength || formGroup.get('tel').errors?.maxlength">{{dataText.errorRegister8}}</span>
          </ion-note>
        </ion-col>

        <!-- CPF -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.cpf}}</ion-label>
            <ion-input type="text" formControlName="cpf" maxlength="11" (keyup.enter)="focusNext($event, 'cnpj')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('cpf').invalid && formGroup.get('cpf').touched">
            <span *ngIf="formGroup.get('cpf').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('cpf').errors?.minlength || formGroup.get('cpf').errors?.maxlength">{{dataText.errorRegister8}}</span>
          </ion-note>
        </ion-col>

        <!-- CNPJ -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.cnpj}}</ion-label>
            <ion-input type="text" formControlName="cnpj" maxlength="14" (keyup.enter)="focusNext($event, 'selectedBank')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('cnpj').invalid && formGroup.get('cnpj').touched">
            <span *ngIf="formGroup.get('cnpj').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('cnpj').errors?.minlength || formGroup.get('cnpj').errors?.maxlength">{{dataText.errorRegisterCNPJ}}</span>
          </ion-note>
        </ion-col>

        <!-- Banco -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.bank}}</ion-label>
            <ion-select formControlName="selectedBank">
              <ion-option *ngFor="let bank of dataInfo.banks">{{bank}}</ion-option>
            </ion-select>
          </ion-item>
        </ion-col>

        <!-- Agência -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.agency}}</ion-label>
            <ion-input type="text" formControlName="agency" (keyup.enter)="focusNext($event, 'account')"></ion-input>
          </ion-item>
        </ion-col>

        <!-- Conta -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.account}}</ion-label>
            <ion-input type="text" formControlName="account" (keyup.enter)="focusNext($event, 'pix')"></ion-input>
          </ion-item>
        </ion-col>

        <!-- Pix -->
        <ion-col col-12 col-md-6>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>Pix</ion-label>
            <ion-input type="text" formControlName="pix" (keyup.enter)="focusNext($event, 'description')"></ion-input>
          </ion-item>
        </ion-col>

        
        <!-- Experiência Profissional -->
        <ion-col col-12>
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.professionalExperience}}</ion-label>
            <ion-textarea formControlName="description" rows="3"></ion-textarea>
          </ion-item>
        </ion-col>

        <!-- Email (somente para novos registros) -->
        <ion-col col-12 col-md-6 *ngIf="!uid_">
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.email}}</ion-label>
            <ion-input type="email" formControlName="email" (keyup.enter)="focusNext($event, 'password')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('email').invalid && formGroup.get('email').touched">
            <span *ngIf="formGroup.get('email').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('email').errors?.email">{{dataText.errorInvalidEmail}}</span>
          </ion-note>
        </ion-col>

        <!-- Senha (somente para novos registros) -->
        <ion-col col-12 col-md-6 *ngIf="!uid_">
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.password}}</ion-label>
            <ion-input type="password" formControlName="password" (keyup.enter)="focusNext($event, 'password1')"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('password').invalid && formGroup.get('password').touched">
            <span *ngIf="formGroup.get('password').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('password').errors?.minlength">{{dataText.errorPasswordLength}}</span>
          </ion-note>
        </ion-col>

        <!-- Repetir Senha (somente para novos registros) -->
        <ion-col col-12 col-md-6 *ngIf="!uid_">
          <ion-item no-lines style="background: white; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
            <ion-label stacked>{{dataText.repeatPassword}}</ion-label>
            <ion-input type="password" formControlName="password1" (keyup.enter)="signUp()"></ion-input>
          </ion-item>
          <ion-note margin-left ion-text color="danger" *ngIf="formGroup.get('password1').invalid && formGroup.get('password1').touched">
            <span *ngIf="formGroup.get('password1').errors?.required">{{dataText.requestdField}}</span>
            <span *ngIf="formGroup.get('password1').errors?.notMatching">{{dataText.passwordNotSame}}</span>
          </ion-note>
        </ion-col>
      </ion-row>
    </form>
  </ion-grid>
</ion-content>

<ion-footer>
  <ion-grid>
    <ion-row>
      <ion-col col-12>
        <button ion-button block class="btn-footer" (click)="signUp()" *ngIf="!uid_">
          {{dataText.add}}
        </button>
        <button ion-button block class="btn-footer" (click)="save()" *ngIf="uid_">
          {{dataText.update}}
        </button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-footer>